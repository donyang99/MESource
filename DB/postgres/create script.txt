--varchar2(character varying),number(numeric),date(timestamp)
create table mes_system_config  (
  item        character varying(20),
  value       char(1),
  validation  character varying(255),
  constraint pk_system_config primary key(item)  
);

create table mes_system_config_file
(
	item          character varying(20),
	user_id       character varying(20),
	file_name     character varying(50),
	contents	    character varying(2000),
	constraint pk_system_config_file primary key(item,user_id)
);

create table mes_system_version
(
	name 				character varying(60),
	version			character varying(20),
	active_date	timestamp,
  previous_version character varying(20),
	modify_user	character varying(10),
	modify_date	timestamp,
	constraint pk_system_version primary key(name)
);

create table mes_system_serial
(
  item               character varying(40)  ,
  key                character varying(200) ,
  serial             integer                ,
  modify_date        timestamp              ,
  constraint pk_system_serial primary key(item,key)
);

create table language_map  (
  language  character varying(10),
  key       character varying(50),
  value     character varying(255),
  constraint pk_language_map primary key(language,key)  
);

create table mes_client_sessions
(
  client_id   character varying(255),
  machine_id  character varying(100),
  server_id   character varying(20),
  start_date  timestamp,
  constraint pk_client_sessions primary key(client_id)
);

--廠別資訊
create table mes_fab(
  sysid         character varying(38)  ,
  fab           character varying(20)  ,
  fab_code      character varying(20)  ,
  org_id        character varying(20)  ,
  create_user   character varying(10)  ,
  create_date   timestamp          ,
  modify_user   character varying(10)  ,
  modify_date   timestamp          ,
  delete_flag   char(1)       default '0',
  constraint pk_fab primary key(sysid),
  constraint uk_fab unique(fab)
);

create table mes_lot_type
(
  sysid         			character varying(38)  ,
  lot_type   				character varying(40)  ,
  description				character varying(255)	,
  check_future_hold    	    char(1)       ,
  check_q_time    			char(1)       ,
  check_dc_self    			char(1)       , --收集項目自我檢查(比對目標設定)
  check_recipe    			char(1)       ,
  check_dc_spec				char(1)       , --收集項目比對參數規格
  check_material 			char(1)       ,
  check_tooling 			char(1)       ,
  create_user   			character varying(10)  ,
  create_date   			timestamp          ,
  modify_user   			character varying(10)  ,
  modify_date   			timestamp          ,
  delete_flag   			char(1)       default '0',
  constraint pk_lot_type primary key(sysid),
  constraint uk_lot_type unique(lot_type)
);


create table mes_reason_code(
  sysid         character varying(38)  ,
  reason_code   character varying(40)  ,
  reason_type   character varying(20)  ,
  owner_dept    character varying(20)  ,
  create_user   character varying(10)  ,
  create_date   timestamp          ,
  modify_user   character varying(10)  ,
  modify_date   timestamp          ,
  delete_flag   char(1)       default '0',
  constraint pk_reason_code primary key(sysid),
  constraint uk_reason_code unique(reason_code)
);
create index idx_reason_code_1 on mes_reason_code
(delete_flag);

create table mes_reason_group(
  sysid         character varying(38)  ,
  group_id      character varying(20)  ,
  description   character varying(255)  ,
  create_user   character varying(10)  ,
  create_date   timestamp          ,
  modify_user   character varying(10)  ,
  modify_date   timestamp          ,
  delete_flag   char(1)       default '0',
  constraint pk_reason_group primary key(sysid),
  constraint uk_reason_group unique(group_id)
);

create table mes_reason_group_link(
  reason_group_sysid    character varying(38)  ,
  reason_code_sysid     character varying(38)  ,
  constraint pk_reason_group_link primary key(reason_group_sysid,reason_code_sysid)
);

create table mes_reason_category(
  sysid         character varying(38)  ,
  reason_category character varying(40)  ,
  reason_class    character varying(40)  ,
  reason_group    character varying(20)  ,
  create_user     character varying(10)  ,
  create_date     timestamp          ,
  modify_user     character varying(10)  ,
  modify_date     timestamp          ,
  delete_flag     char(1)       default '0',
  constraint pk_reason_category primary key(sysid),
  constraint uk_reason_category unique(reason_category,reason_class)
);
create index idx_reason_category_1 on mes_reason_category
(reason_group);

create table mes_txn_reason(
  txn_sysid       character varying(45)  ,
  reason_code     character varying(40)  ,
  comments        character varying(255) ,
  constraint pk_txn_reason primary key(txn_sysid)
);

create table mes_privilege_string(
  sysid             character varying(38)  ,
  privilege_string  character varying(255) ,
  description       character varying(255) ,
  create_user       character varying(10)  ,
  create_date       timestamp          default now(),
  modify_user       character varying(10)  ,
  modify_date       timestamp          default now(),
  delete_flag       char(1)       default '0',
  constraint pk_privilege_string primary key(sysid),
  constraint uk_privilege_string unique(privilege_string)
);

--使用者主檔
create table mes_user_profile ( 
    sysid                          character varying(38)  ,
    user_id                        character varying(10)  ,    --使用者Id
    windows_account								 character varying(30)	 ,		--windows帳號
    user_name                      character varying(20)  ,    --使用者姓名
    fab                            character varying(40)  ,    --使用者所屬廠別
    division                       character varying(40)  ,    --
    email                          character varying(50)  ,    --電子郵件
    email2                         character varying(50)  ,    --電子郵件
    mobile                         character varying(15)  ,    --電話
    mobile2                        character varying(15)  ,    --電話
    pc_address                     character varying(40)  ,    --電腦位置(ip or name)
    password                       character varying(50)  ,    --密碼
    language                       character varying(10)  ,
    privilege_group                character varying(40)  ,
	current_login_info             character varying(100) ,		--當前登入的資訊(WorkFlow.ClientId)
    create_user                    character varying(10)  ,
    create_date                    timestamp          default now(),
    modify_user                    character varying(10)  ,
    modify_date                    timestamp          default now(),
    delete_flag                    char(1)        default '0',    --0=deactived|1=actived
    Constraint pk_user_profile primary Key(sysid),
    Constraint uk_user_profile unique(user_id),
    Constraint uk_user_profile_2 unique(windows_account)
);

--1. userGroup to userId
--2. userGroup to mes_privilege_string
--3. userId to mes_privilege_string
create table mes_group_user_privilege(
  from_id    character varying(40)  ,
  to_id     character varying(38)  ,
  constraint pk_group_user_privilege primary key(from_id,to_id)
);
create index idx_group_user_1 on mes_group_user_privilege
(from_id);
create index idx_group_user_2 on mes_group_user_privilege
(to_id);

--1. userGroup to stepId
--2. userId to stepId
create table mes_group_user_step(
  from_id    character varying(40)  ,
  to_id     character varying(40)  ,
  constraint pk_group_user_step primary key(from_id,to_id)
);
create index idx_group_user_step_1 on mes_group_user_step
(from_id);

create table mes_user_login(
  sysid         character varying(38)  ,
  user_id       character varying(10)  ,
  pc_name       character varying(40)  ,
  login_date    timestamp          ,
  logout_date   timestamp          ,
  constraint pk_user_login primary key(sysid)
);

create table mes_misc(
  item          character varying(40)  ,
  value         character varying(255) ,
  remark        character varying(255) ,
  modify_user   character varying(20)  ,
  modify_date   timestamp          default now(),
  constraint pk_misc primary key(item,value)
);

create table mes_carrier_type(
  sysid           character varying(38)  ,
  carrier_type    character varying(20)  ,
  component_size  numeric(2,0)   ,
  capacity        numeric(5,0)   ,
  description     character varying(255) ,
  create_user     character varying(10)  ,
  create_date     timestamp          ,
  modify_user     character varying(10)  ,
  modify_date     timestamp          ,
  delete_flag     char(1)       default '0',
  constraint pk_carrier_type primary key(sysid),
  constraint uk_carrier_type unique(carrier_type)
);

create table mes_carrier_id(
  sysid           character varying(38)  ,
  carrier_id      character varying(40)  ,
  carrier_type    character varying(20)  ,
  rf_id           character varying(40)  ,
  status          character varying(20)  ,
  lot_id          character varying(40)  ,
  component_qty   numeric(5,0)   default 0,
  location        character varying(40)  ,
  used_count      numeric(5,0)   default 0,
  clean_count     numeric(5,0)   default 0,
  last_clean_user character varying(10)  ,
  last_clean_date timestamp          ,
  create_user     character varying(10)  ,
  create_date     timestamp          ,
  modify_user     character varying(10)  ,
  modify_date     timestamp          ,
  delete_flag     char(1)       default '0',
  tag             character varying(50)  ,
  txnstamp        integer       default 0,
  last_txn_sysid  character varying(38)  ,
  constraint pk_carrier_id primary key(sysid),
  constraint uk_carrier_id unique(carrier_id)
);
create index idx_carrier_id_1 on mes_carrier_id
(carrier_type);
create index idx_carrier_id_2 on mes_carrier_id
(lot_id);
create index idx_carrier_id_3 on mes_carrier_id
(sysid,txnstamp);

create table mes_carrier_history(
  txn_sysid       character varying(38)  ,
  main_txn_sysid  character varying(38)  ,
  last_txn_sysid  character varying(38)  ,
  carrier_id      character varying(40)  ,
  status          character varying(20)  ,
  activity        character varying(20)  ,
  lot_id          character varying(40)  ,
  component_qty   numeric(5,0)   default 0,
  location        character varying(40)  ,
  used_count      numeric(5,0)   default 0,
  clean_count     numeric(5,0)   default 0,
  txnstamp        integer       default 0,
  grouphistkey    character varying(38)  ,
  modify_user     character varying(10)  ,
  modify_date     timestamp          ,
  delete_flag     char(1)       default '0',
  constraint pk_carrier_history primary key(txn_sysid)
);
create index idx_carrier_history_1 on mes_carrier_history
(last_txn_sysid);

--======Equipment Module======================================
create table mes_eqp_state(
  sysid           character varying(38)  ,
  state           character varying(40)  ,
  description     character varying(255) ,
  available       char(1)       ,
  color           integer       ,
  create_user     character varying(10)  ,
  create_date     timestamp          default now(),
  modify_user     character varying(10)  ,
  modify_date     timestamp          default now(),
  delete_flag     char(1)       default '0',
  constraint pk_eqp_state primary key(sysid),
  constraint uk_eqp_state unique(state)
);

create table mes_eqp_state_transfer(
  from_state    character varying(40)  not null,
  to_state      character varying(40)  not null,
  division      character varying(40)  ,
  constraint uk_eqp_state_transfer unique(from_state,to_state,division)
);

create table mes_eqp_type(
  sysid           character varying(38)  ,
  eq_type         character varying(40)  ,
  description     character varying(255) ,
  owner           character varying(10)  ,
  tool_type       numeric(1,0)   default 0,--0:生產機台，1:量測機台，2:機台內生產單元，3:Loader，4:Unlader，5:Both
  capacity        integer       ,
  track_count     numeric(3,0)   default 0,--軌道數
  parameter_count numeric(3,0)   default 0,--設備參數數量
  consume_type    numeric(1,0)   default 0,--0:by Lot，1:by Lot Qty
  counter_flag    char(1)      default '0',
  create_user     character varying(10)  ,
  create_date     timestamp          default now(),
  modify_user     character varying(10)  ,
  modify_date     timestamp          default now(),
  delete_flag     char(1)       default '0',
  constraint pk_eqp_type primary key(sysid),
  constraint uk_eqp_type unique(eq_type)
);
create index idx_eqp_type_1 on mes_eqp_type
(tool_type);

create table mes_eqp_type_track
(
  eq_type         character varying(40)  ,
  track           character varying(20)  , -- 軌道名
  seq             numeric(3,0)   ,
  modify_user     character varying(10)  ,
  modify_date     timestamp          ,
  constraint pk_eqp_type_track primary key(eq_type,track)
);
create index idx_eqp_type_track_1 on mes_eqp_type_track
(eq_type);

create table mes_eqp_equipment(
  sysid           character varying(38)  ,
  equipment_id    character varying(40)  ,
  issue_state     character varying(10)  ,
  description     character varying(255) ,
  eq_type         character varying(40)  ,
  owner           character varying(10)  ,
  state           character varying(40)  ,
  reserved_by     character varying(40)  ,
  capacity_used   integer       default 0,
  counter         integer       default 0,
  last_order_id   character varying(40)  ,
  lot_id          character varying(40)  ,
  recipe          character varying(40)  ,
  fab             character varying(40)  ,
  line            character varying(40)  ,
  seq             numeric(2,0)   default 0,
  txnstamp        integer default 0,
  setup_info      character varying(38)  ,
  last_setup_info character varying(40)  , --最後一次架機資訊key值，setup_info@setup_info_flag
  last_setup_date timestamp          , --最後一次更動架機資訊日期
  setup_info_flag	char(1)				, --是否已使用(Lot有過帳記錄)
  last_txn_sysid  character varying(38)  ,
  last_change_state       character varying(38)  ,
  validated_spec_sysid    character varying(38)  , --已檢查過的生產規範sysid
  tooling_setup_info      character varying(38)  ,
  validated_spec_tooling  character varying(38)  ,
  create_user     character varying(10)  ,
  create_date     timestamp          ,
  modify_user     character varying(10)  ,
  modify_date     timestamp          ,  
  delete_flag     char(1)       default '0',
  constraint pk_eqp_equipment primary key(sysid),
  constraint uk_eqp_equipment unique(equipment_id)
);
create index idx_eqp_equipment_1 on mes_eqp_equipment
(eq_type);
create index idx_eqp_equipment_2 on mes_eqp_equipment
(fab);
create index idx_eqp_equipment_3 on mes_eqp_equipment
(sysid,txnstamp);

create table mes_eqp_equipment_link(
  from_sysid    character varying(38)  ,
  to_sysid      character varying(38)  ,
  constraint pk_eqp_equipment_link primary key(to_sysid)
);
create index idx_eqp_equipment_link_1 on mes_eqp_equipment_link
(from_sysid);

create table mes_eqp_group_link(
  equipment_group        character varying(20)  ,
  equipment_sysid         character varying(38)  ,
  constraint pk_eqp_group_link primary key(equipment_group,equipment_sysid)
);

create table mes_eqp_setup_info(
  sysid           character varying(38)  ,
  eqp_setup_info  character varying(38)  , --to mes_eqp_equipment.setup_info
  material_type   character varying(40)  , --物料類別
  part_no         character varying(40)  , --來料料號
  material_lot_id character varying(40)  , --來料批號
  position        character varying(20)  , --位置
  quantity        numeric(10,3) default 0, --數量
  setup_user      character varying(10)  , --上料人員
  setup_date      timestamp          , --上料時間
  modify_date     timestamp          ,
  constraint pk_eqp_setup_info primary key(sysid)
);
create index idx_eqp_setup_info_1 on mes_eqp_setup_info
(eqp_setup_info);

create table mes_eqp_history(
  txn_sysid       character varying(38)  ,
  main_txn_sysid  character varying(38)  ,
  last_txn_sysid  character varying(38)  ,
  last_change_state  character varying(38)  ,
  equipment_id    character varying(40)  ,
  state           character varying(40)  ,
  reserved_by     character varying(40)  ,
  activity        character varying(20)  ,
  capacity_used   integer       default 0,
  counter         integer       default 0,
  lot_id          character varying(40)  ,
  recipe          character varying(40)  ,
  fab             character varying(40)  ,
  txnstamp        integer default 0,
  setup_info      character varying(38)  ,
  grouphistkey    character varying(38)  ,
  eq_parm_seq     integer                ,
  modify_user     character varying(10)  ,
  modify_date     timestamp          ,
  delete_flag     char(1)       default '0',
  constraint pk_eqp_history primary key(txn_sysid)
);
create index idx_eqp_history_1 on mes_eqp_history
(equipment_id);
create index idx_eqp_history_2 on mes_eqp_history
(last_change_state);
create index idx_eqp_history_3 on mes_eqp_history
(activity);
create index idx_eqp_history_4 on mes_eqp_history
(modify_date);

create table mes_eqp_history_setup_info(
  eqp_setup_info  character varying(38)  , --to mes_eqp_equipment.setup_info
  material_type   character varying(40)  , --物料類別
  part_no         character varying(40)  , --來料料號
  material_lot_id character varying(40)  , --來料批號
  position        character varying(20)  , --位置
  quantity        numeric(10,3) default 0, --數量
  setup_user      character varying(10)  , --上料人員
  modify_date     timestamp          
);
create index idx_history_setup_info_1 on mes_eqp_history_setup_info
(eqp_setup_info);

create table mes_eqp_setup_remain_info(
  sysid           character varying(38)  ,
  txn_sysid       character varying(38)  , --sysid of eqp_history
  equipment_id    character varying(40)  , 
  material_type   character varying(40)  , --物料類別
  part_no         character varying(40)  , --來料料號
  material_lot_id character varying(40)  , --來料批號
  quantity        numeric(10,3) default 0, --數量
  create_user     character varying(10)  , --下料人員
  create_date     timestamp          , --下料時間 
  modify_user     character varying(10)  , --退料人員
  modify_date     timestamp          , --退料時間
  delete_flag     char(1)       default '0', --0:未退料，1:已退料 
  constraint pk_eqp_setup_remain_info primary key(sysid)
);
create index idx_eqp_setup_remain_info_1 on mes_eqp_setup_remain_info
(equipment_id,delete_flag);

create table mes_eqp_history_tooling_info(
  tooling_setup_info  character varying(38)  , 
  tooling_id          character varying(40)  , 
  part_no             character varying(40)	, 
  current_count       numeric(6,0)  , 
  use_count           numeric(6,0)  ,
  setup_user          character varying(10)  , 
  modify_date         timestamp          
);
create index idx_history_tooling_info_1 on mes_eqp_history_tooling_info
(tooling_setup_info);

create table mes_eqp_parameter
(
  sysid           character varying(38) ,
  parameter       character varying(40) ,
  eq_data_id      character varying(40) ,
  data_type       numeric(1)   default 0,
  length          numeric(3)   default 0,
  option_list     character varying(255),
  description     character varying(255),
  modify_user     character varying(10) ,
  modify_date     timestamp     ,
  constraint pk_eqp_parameter primary key(sysid),
  constraint uk_eqp_parameter unique(parameter)
);

create table mes_eqp_type_parameter
(
  eq_type         character varying(40)  ,
  parameter_sysid character varying(38)  , 
  table_name      character varying(40)  , 
  column_name     character varying(40)  , 
  eq_data_id      character varying(40)  , 
  seq             numeric(3,0)  ,
  required        numeric(1)     default 0, 
  modify_user     character varying(10)  ,
  modify_date     timestamp      ,
  constraint pk_eqp_type_parameter primary key(eq_type,parameter_sysid),
  constraint uk_eqp_type_parameter unique(eq_type,table_name,column_name)
);
create index idx_eqp_type_parameter_1 on mes_eqp_type_parameter
(eq_type);

create table mes_eqp_parm_seq
(
    equipment_id    character varying(40)  , 
	eq_parm_seq     integer       , 
	constraint pk_eqp_parm_seq primary key(equipment_id)
);

create table mes_eqp_parm_data
(
  equipment_id    character varying(40)  ,
  eq_parm_seq     integer       ,  
  lot_id          character varying(40)  , 
  check_result    numeric(1)     default 0, 
  fail_info       character varying(255) , 
  modify_user     character varying(10)  ,
  modify_date     timestamp      , 
  parm_1          character varying(10)  , 
  parm_2          character varying(20)  , 
  parm_3          numeric(3,1)  , 
  constraint pk_eqp_parm_data primary key(equipment_id)
);

create table mes_eqp_parm_data_his
(
  equipment_id    character varying(40)  , 
  eq_parm_seq     integer       ,
  lot_id          character varying(40)  , 
  check_result    numeric(1)     default 0, 
  fail_info       character varying(255) , 
  modify_user     character varying(10)  ,
  modify_date     timestamp      , 
  parm_1          character varying(10)  , 
  parm_2          character varying(20)  , 
  parm_3          numeric(3,1)   
);
create index idx_eqp_parm_data_his_1 on mes_eqp_parm_data_his
(equipment_id,eq_parm_seq);
create index idx_eqp_parm_data_his_2 on mes_eqp_parm_data_his
(equipment_id,modify_date);
--======ProcessPlan Module======================================
create table mes_prp_rule(
  sysid           character varying(38)  ,
  rule_id         character varying(40)  ,
  program_class   character varying(255) ,  
  description     character varying(255) ,
  dispatch_flag       char(1)   ,
  create_user     character varying(10)  ,
  create_date     timestamp          default now(),
  modify_user     character varying(10)  ,
  modify_date     timestamp          default now(),
  delete_flag     char(1)       default '0',
  constraint pk_prp_rule primary key(sysid),
  constraint uk_prp_rule unique(rule_id)
);

create table mes_prp_step(
  sysid           character varying(38)  ,
  step_id         character varying(40)  ,
  version         numeric(3,0)   , 
  description     character varying(255) ,
  stage           character varying(40)  ,
  step_code       character varying(40)  ,
  equipment_group character varying(40)  ,
  component_type  character varying(40)  ,
  issue_state     character varying(10)  ,
  fab             character varying(40)  ,
  extension_name  character varying(40)  ,
  seq             character varying(40)  ,
  create_user     character varying(10)  ,
  create_date     timestamp          ,
  modify_user     character varying(10)  ,
  modify_date     timestamp          ,
  delete_flag     char(1)       default '0',
  flag            numeric(3,0)   ,
  constraint pk_prp_step primary key(sysid),
  constraint uk_prp_step unique(step_id,version)
);
create index idx_prp_step_1 on mes_prp_step
(issue_state);
create index idx_prp_step_2 on mes_prp_step
(equipment_group);
create index idx_prp_step_3 on mes_prp_step
(step_id,flag);
create index idx_prp_step_4 on mes_prp_step
(fab);
create index idx_prp_step_5 on mes_prp_step
(step_id,issue_state,stage);

create table mes_prp_step_rule(
  step_sysid    character varying(38)  ,
  rule_sysid    character varying(38)  ,
  seq           numeric(2,0)   ,
  constraint pk_prp_step_rule primary key(step_sysid,rule_sysid,seq)
);
create index idx_prp_step_rule_1 on mes_prp_step_rule
(step_sysid);
create index idx_prp_step_rule_2 on mes_prp_step_rule
(rule_sysid);

create table mes_prp_routing(
  sysid           character varying(38)  ,
  route_id        character varying(40)  ,
  version         numeric(3,0)   ,  
  description     character varying(255) ,
  route_type      character varying(40)  ,
  issue_state     character varying(10)  ,
  create_user     character varying(10)  ,
  create_date     timestamp          ,
  modify_user     character varying(10)  ,
  modify_date     timestamp          ,
  delete_flag     char(1)       default '0',
  flag            numeric(3,0)   ,
  constraint pk_prp_routing primary key(sysid),
  constraint uk_prp_routing unique(route_id,version)
);
create index idx_prp_routing_1 on mes_prp_routing
(route_type);
create index idx_prp_routing_2 on mes_prp_routing
(issue_state);
create index idx_prp_routing_3 on mes_prp_routing
(delete_flag);
create index idx_prp_routing_4 on mes_prp_routing
(route_id,flag);

create table mes_prp_routing_node(
  sysid           character varying(38)  ,
  route_sysid     character varying(38)  ,
  parent_sysid    character varying(38)  ,  
  node_id         character varying(40)  ,
  node_kind       character varying(10)  ,
  node_type       character varying(10)  ,
  pos_x           numeric(3,0)   ,
  pos_y           numeric(3,0)   ,
  node_ref        character varying(38)  ,
  handle          character varying(40)  ,
  iterate         numeric(2,0)           default 1 ,
  is_rework       char(1)       ,
  constraint pk_prp_routing_node primary key(sysid)
);
create index idx_prp_routing_node_1 on mes_prp_routing_node
(route_sysid);
create index idx_prp_routing_node_2 on mes_prp_routing_node
(parent_sysid);
create index idx_prp_routing_node_3 on mes_prp_routing_node
(node_ref);
create index idx_prp_routing_node_4 on mes_prp_routing_node
(handle);

create table mes_prp_routing_path(
  route_sysid     character varying(38)  ,
  from_node       character varying(38)  ,
  path            character varying(40)  ,
  to_node         character varying(38)  ,
  color           integer       
);
create index idx_prp_routing_path_1 on mes_prp_routing_path
(route_sysid);
create index idx_prp_routing_path_2 on mes_prp_routing_path
(from_node);
create index idx_prp_routing_path_3 on mes_prp_routing_path
(to_node);

--料號類型
create table mes_prp_product_type(
  sysid         character varying(38)  ,
  product_type  character varying(20)  ,
  description   character varying(255) ,
  create_user   character varying(10)  ,
  create_date   timestamp          ,
  modify_user   character varying(10)  ,
  modify_date   timestamp          ,
  delete_flag   char(1)       default '0',
  constraint pk_product_type primary key(sysid),
  constraint uk_product_type unique(product_type)
);

create table mes_prp_product(
  sysid           character varying(38)  ,
  product_id      character varying(40)  ,
  product_type    character varying(20)  ,
  fab		          character varying(40)	,
  route_id        character varying(40)  ,
  compose_size	  numeric(5,0)	  , --內包數量，批號限定數量
  product_size	  character varying(40)	, --產品尺寸
  packing_quantity numeric(5,0)  , --外包規則，箱號限定數量
  issue_state     character varying(10)  ,
  description     character varying(255) ,
  create_user     character varying(10)  ,
  create_date     timestamp          ,
  modify_user     character varying(10)  ,
  modify_date     timestamp          ,
  delete_flag     char(1)       default '0',
  constraint pk_prp_product primary key(sysid),
  constraint uk_prp_product unique(product_id)
);
create index idx_prp_product_1 on mes_prp_product
(product_type);
create index idx_prp_product_2 on mes_prp_product
(issue_state);

create table mes_prp_product_link(
  product_sysid     character varying(38)  , --sysid to mes_prp_product
  route_id          character varying(40)  , --route_id to mes_prp_routing
  constraint pk_prp_product_link primary key(product_sysid,route_id)
);

create table mes_prp_product_dc_skip
(
  product_id        character varying(40)  , --mes_prp_product.id
  dc_item_sysid     character varying(38)  , --sysid to mes_prp_step_dc_item
  constraint pk_prp_product_dc_skip primary key(product_id,dc_item_sysid)
);

create table mes_prp_step_dc_item(
  sysid             character varying(38)  ,
  name              character varying(40)  ,
  description       character varying(255) ,
  data_type         character varying(10)  , --Numeric, String, Options
  length            numeric(3,0)   ,
  option_list       character varying(255) ,
  modify_target     character varying(40)  , --要寫入的物件類型
  attribute_name    character varying(40)  , --要寫入物件的屬性名
  column_name       character varying(40)  , --Lot屬性名對應的資料庫欄位名
  assign_from       character varying(40)  , --自動帶入值的來源物件。Lot, Equipment, Order
  assign_attribute  character varying(40)  , --自動帶入值的屬性名
  compare_value     character varying(500) , --比對來源。空白:即輸入的值，非空白:查詢結果為單一值的sql(條件中帶?代表輸入的值)
  compare_source_db character varying(40)  , --查詢比對來源的資料來源(sqlExtension的dbName)
  compare_type      char(1) default '0', --比對目標值的方式。0:不比對，1:設定的方式(下列設定)，2:開發自定義組件的方式(組件名放在compare_to欄位)
  compare_to        character varying(40)  , --比對值的目標物件。Lot, Equipment, Order
  compare_attribute character varying(40)  , --比對值的屬性名
  compare_to_value  character varying(500) , --比對目標。空白:即帶入值(compare_to.compare_attribute)，非空白:查詢結果為單一值的sql(條件中帶?代表帶入的值)
  compare_to_db     character varying(40)  , --查詢比對目標的資料來源(sqlExtension的dbName) 
  compare_operator  character varying(2)   , --比對運算子   
  enabled           char(1)       default '1', --是否可編輯，只有自動帶值時，才能設為不可編輯
  visible           char(1)       default '1', --是否可見，只有自動帶值時，才能設為不可見
  create_user       character varying(10)  ,
  create_date       timestamp          ,
  modify_user       character varying(10)  ,
  modify_date       timestamp          ,
  delete_flag       char(1)       default '0',
  constraint pk_prp_step_dc_item primary key(sysid),
  constraint uk_prp_step_dc_item unique(name)
);

create table mes_prp_step_dc_link(
  step_id         character varying(40)  ,
  dc_item_sysid   character varying(38)  ,
  seq             numeric(2,0)   ,
  required        char(1)       ,
  timing          char(1) default '0' ,   --0=trackIn, 1=trackOut
  check_fail_path character varying(40),  --檢查失敗時回傳交易的路徑(出機收集才有作用)
  check_seq       numeric(2,0) default 0, --多個有回傳交易路徑的項目同時失敗時要回傳的路徑優先級
  message         character varying(100),
  constraint pk_prp_step_dc_link primary key(step_id,dc_item_sysid)
);
create index idx_prp_step_dc_link_1 on mes_prp_step_dc_link
(step_id);
create index idx_prp_step_dc_link_2 on mes_prp_step_dc_link
(dc_item_sysid);

create table mes_prp_step_station(
  step_id         character varying(40)  ,
  station         character varying(40)  ,
  seq             numeric(2,0)   ,
  constraint pk_prp_step_station primary key(step_id,station)
);
create index idx_prp_step_station_1 on mes_prp_step_station
(step_id);

--=====WIP Module==================================================================
create table mes_wip_lot(
	sysid          character varying(38)  ,
	order_id       character varying(40)  ,
	lot_id         character varying(40)  ,
	description    character varying(255) ,
	lot_type       character varying(40)  ,
	component_type character varying(40)  , --lot當下的原料型態(對應step的component_type)
	product_id     character varying(40)  ,
  product_type   character varying(20)  ,
	route_id       character varying(40)  ,
	route_version  numeric(3,0)   ,
	spec_id        character varying(40)  ,
	spec_sysid     character varying(38)  , --參數模組串接鍵
	status         character varying(40)  ,
	last_status    character varying(40)  ,
	fab            character varying(40)  ,	
	equipment_id   character varying(40)  ,
	last_equipment character varying(40)  ,
	step_id        character varying(40)  ,
	step_version   numeric(3,0)   ,
	iterate         numeric(2,0)  default 1 ,
	node_handle     character varying(40)  , --handle to mes_prp_routing_node
	last_node_handle character varying(40) , --handle to mes_prp_routing_node
	rule_id        character varying(40)  ,
	rule_seq       numeric(2,0)   ,
	location       character varying(40)  , --bank時的儲位
	start_quantity numeric(10,3)  ,
	quantity       numeric(10,3)  ,
  finished_qty   numeric(10,3)  , --當前站點已完工數
	unit           character varying(20)  ,
	component_info character varying(38)  , --lot_component_info to mes_wip_lot_component
	priority       numeric(2,0)   ,
	carrier_id     character varying(40)  ,
	carrier_position numeric(3)  ,
	q_time_count   numeric(2,0)   , --queue control count
	rework_count   numeric(2,0)   ,
	last_hold_sysid character varying(45) , --sysid to mes_wip_lot_hold_release	
	customer_id    character varying(40)  ,
	customer_lot_id character varying(40) ,
	due_date       timestamp          ,
	customer_due_date  timestamp      ,
	lot_tracking_sysid character varying(38)  , --sysid to mes_wip_lot_tracking	
	batch_id       character varying(40)      ,
	txnstamp       integer default 0 ,
	last_txn_sysid character varying(45)  , --sysid to mes_wip_lot_history************************
  last_defect_txn  character varying(45),
	last_move_date timestamp          , --最後一次移動的時間
	rule_result		 character varying(40)  , --最後一個TrackOut Rule的判定結果
	source_parent  character varying(38)  , --sysid to mes_wip_lot, 原料批
	top_parent     character varying(38)  , --sysid to mes_wip_lot, 分批的最上層母批
	split_parent   character varying(38)  , --sysid to mes_wip_lot, 母批(分批的母批)，由哪一批分出來的
	merge_parent   character varying(38)  , --sysid to mes_wip_lot, 母批(併批的母批)，併到哪一批了
	child_count    integer default 0, --子批數量
	owner          character varying(10)  ,
	remark         character varying(255) ,
	isDispatching  character varying(255) ,
  create_user    character varying(10)  ,
	create_date    timestamp          ,	
	modify_user    character varying(10)  ,
	modify_date    timestamp          ,
	delete_flag    char(1)  default '0',  --for ERP是否已回報(0: not yet, 1: reported)    
  constraint pk_wip_lot primary key(sysid),
  constraint uk_wip_lot unique(lot_id)
);
create index idx_wip_lot_1 on mes_wip_lot
(fab);
create index idx_wip_lot_2 on mes_wip_lot
(step_id);
create index idx_wip_lot_3 on mes_wip_lot
(batch_id);
create index idx_wip_lot_4 on mes_wip_lot
(equipment_id);
create index idx_wip_lot_5 on mes_wip_lot
(status);
create index idx_wip_lot_6 on mes_wip_lot
(carrier_id);
create index idx_wip_lot_7 on mes_wip_lot
(order_id);
create index idx_wip_lot_8 on mes_wip_lot
(last_txn_sysid);

create table mes_wip_lot_delete(
	sysid          character varying(38)  ,
	order_id       character varying(40)  ,
	lot_id         character varying(40)  ,
	description    character varying(255) ,
	lot_type       character varying(40)  ,
	component_type character varying(40)  , --lot當下的原料型態(對應step的component_type)
	product_id     character varying(40)  ,
  product_type   character varying(20)  ,
	route_id       character varying(40)  ,
	route_version  numeric(3,0)   ,
	spec_id        character varying(40)  ,
	spec_sysid     character varying(38)  , --參數模組串接鍵
	status         character varying(40)  ,
	last_status    character varying(40)  ,
	fab            character varying(40)  ,	
	equipment_id   character varying(40)  ,
	last_equipment character varying(40)  ,
	step_id        character varying(40)  ,
	step_version   numeric(3,0)   ,
	iterate         numeric(2,0)  default 1 ,
	node_handle     character varying(40)  , --handle to mes_prp_routing_node
	last_node_handle character varying(40) , --handle to mes_prp_routing_node
	rule_id        character varying(40)  ,
	rule_seq       numeric(2,0)   ,
	location       character varying(40)  , --bank時的儲位
	start_quantity numeric(10,3)  ,
	quantity       numeric(10,3)  ,
  finished_qty   numeric(10,3)  , --當前站點已完工數
	unit           character varying(20)  ,
	component_info character varying(38)  , --lot_component_info to mes_wip_lot_component
	priority       numeric(2,0)   ,
	carrier_id     character varying(40)  ,
	carrier_position numeric(3)  ,
	q_time_count   numeric(2,0)   , --queue control count
	rework_count   numeric(2,0)   ,
	last_hold_sysid character varying(45) , --sysid to mes_wip_lot_hold_release	
	customer_id    character varying(40)  ,
	customer_lot_id character varying(40) ,
	due_date       timestamp          ,
	customer_due_date  timestamp      ,
	lot_tracking_sysid character varying(38)  , --sysid to mes_wip_lot_tracking	
	batch_id       character varying(40)      ,
	txnstamp       integer default 0 ,
	last_txn_sysid character varying(45)  , --sysid to mes_wip_lot_history************************
  last_defect_txn  character varying(45),
	last_move_date timestamp          , --最後一次移動的時間
	rule_result		 character varying(40)  , --最後一個TrackOut Rule的判定結果
	source_parent  character varying(40)  , --lotId to mes_wip_lot, 原料批
	top_parent     character varying(40)  , --lotId to mes_wip_lot, 分批的最上層母批
	split_parent   character varying(40)  , --lotId to mes_wip_lot, 母批(分批的母批)，由哪一批分出來的
	merge_parent   character varying(40)  , --lotId to mes_wip_lot, 母批(併批的母批)，併到哪一批了
	child_count    integer default 0, --子批數量
	owner          character varying(10)  ,
	remark         character varying(255) ,
	isDispatching  char(1)  default '0',
  create_user    character varying(10)  ,
	create_date    timestamp          ,	
	modify_user    character varying(10)  ,
	modify_date    timestamp          ,
	delete_flag    char(1)  default '0',  --for ERP是否已回報(0: not yet, 1: reported)    
  constraint pk_wip_lot_delete primary key(sysid),
  constraint uk_wip_lot_delete unique(lot_id)
);

create table mes_wip_batch(
	sysid          character varying(38)  ,
	batch_id       character varying(40)  ,
	description    character varying(255) ,
	comments       character varying(255) ,
	start_step_id  character varying(40)  ,
	end_step_id    character varying(40)  ,
	create_user    character varying(10)  ,
	create_date    timestamp          ,	
	modify_user    character varying(10)  ,
	modify_date    timestamp          ,
	delete_flag    char(1)  default '0',  --0:作用中，1:取消批次
  constraint pk_wip_batch primary key (sysid),
  constraint uk_wip_batch unique (batch_id)
);
create index idx_wip_batch_1 on mes_wip_batch 
(delete_flag);

create table mes_wip_lot_component(
	lot_component_info character varying(38)  ,
	component_sysid    character varying(38)  ,
  carrier_id         character varying(40)  ,
  position           integer      ,
  modify_date        timestamp          ,
  constraint pk_wip_lot_component primary key (component_sysid)
);
create index idx_wip_lot_component_1 on mes_wip_lot_component 
(lot_component_info);
create index idx_wip_lot_component_2 on mes_wip_lot_component 
(carrier_id);

create table mes_wip_component(
	sysid          character varying(38)  ,
	component_id   character varying(50)  ,
  status         character varying(40)  , --Active, Defect, Scrap
  integrity      numeric(4,3)   default 1,
  original_lot   character varying(38)  , --sysid to mes_wip_lot 
	create_user    character varying(10)  ,
	create_date    timestamp          ,	
	modify_user    character varying(10)  ,
	modify_date    timestamp          ,
	delete_flag    char(1)  default '0',  --0:作用中，1:取消批次          
  constraint pk_wip_component primary key (sysid),
  constraint uk_wip_component unique (component_id)
);
create index idx_wip_component_1 on mes_wip_component 
(delete_flag);

create table mes_wip_lot_tracking(
	sysid          character varying(38)  ,
	lot_id         character varying(40)  ,
	sub_route_id   character varying(40)  ,
  step_id        character varying(40)  ,
  step_handle    character varying(40)  ,
  stage          character varying(40)  ,
  equipment_id   character varying(40)  ,
  spec_id        character varying(40)  ,  --進機時的Spec Id
  move_in_date   timestamp          ,
  track_in_date  timestamp          ,
  track_out_date timestamp          ,
  move_out_date  timestamp          ,
  move_in_qty    numeric(10,3)   ,
  track_in_qty   numeric(10,3)   ,
  track_out_qty  numeric(10,3)   ,
  move_out_qty   numeric(10,3)   ,
  move_in_sysid  character varying(45)  ,
  track_in_sysid character varying(45)  ,
  track_out_sysid character varying(45) ,
  move_out_sysid character varying(45)  ,
  is_rework      char(1)       ,
  seq            integer       ,
	delete_flag    char(1)  default '0',  --0:未完整完成站點作業，1:已完整完成站點作業         
  constraint pk_wip_lot_tracking primary key (sysid)
);
create index idx_wip_lot_tracking_1 on mes_wip_lot_tracking 
(lot_id,seq);
create index idx_wip_lot_tracking_2 on mes_wip_lot_tracking 
(track_out_date);

create table mes_wip_future_hold(
	sysid              character varying(38)  ,
	id                 character varying(40)  , --order_id or lot_id or product_id or route_id
	kind               char(1)       , --0:order, 1:lot, 2:route, 3:product	
  step_id            character varying(40)  ,
  step_handle        character varying(40)  ,
  timing             char(1)  , --0=trackIn, 1=trackOut
  reason_code        character varying(40)  , 
  start_date         timestamp          ,
  expire_date        timestamp          ,
  create_user        character varying(10)  ,
	create_date        timestamp          ,	
	modify_user        character varying(10)  ,
	modify_date        timestamp          ,
	active             char(1)  default '1', --是否作用中。1:還在作用中，0:已經執行過(不在作用中)
	delete_flag        char(1)  default '0',    
  constraint pk_wip_future_hold primary key (sysid)
);
create index idx_wip_future_hold_1 on mes_wip_future_hold 
(expire_date,active,delete_flag);

create table mes_wip_lot_hold_release(
	sysid              character varying(45)  ,
	lot_id             character varying(40)  ,
	step_id            character varying(40)  ,
  hold_reason        character varying(40)  , 
  release_reason     character varying(40)  ,  
  hold_user          character varying(10)  ,
	hold_date          timestamp          ,	
	release_user       character varying(10)  ,
	release_date       timestamp          ,
	future_hold_sysid  character varying(38)  , --sysid to mes_wip_future_hold,如果是手動即時扣押，就不會有值
	release_txn_sysid  character varying(45)  , --sysid to mes_wip_history(with Release Activity)
	delete_flag        char(1)  default '0', --0:not release yet, 1:released already
  constraint pk_wip_lot_hold_release primary key (sysid)
);
create index idx_wip_lot_hold_release_1 on mes_wip_lot_hold_release 
(lot_id,delete_flag);
create index idx_wip_lot_hold_release_2 on mes_wip_lot_hold_release 
(step_id,delete_flag);
create index idx_wip_lot_hold_release_3 on mes_wip_lot_hold_release 
(delete_flag);
create index idx_wip_lot_hold_release_4 on mes_wip_lot_hold_release 
(hold_date);

create table mes_wip_q_time_setting(
	sysid          character varying(38)  ,
	product_id     character varying(40)  ,
	route_id       character varying(40)  ,
	from_step_id   character varying(40)  ,
	to_step_id     character varying(40)  ,
	q_time         integer       , -- minute
	q_time_type    char(1)       , -- 0:在設定時間內，1:需超過設定時間
	action         char(1) default '0', --0:None,1:BackStep,2:Hold,3:BackAndHold
	create_user    character varying(10)  ,
	create_date    timestamp          ,	
	modify_user    character varying(10)  ,
	modify_date    timestamp          ,
	delete_flag    char(1)  default '0',
  constraint pk_wip_q_time_setting primary key (sysid),
  constraint uk_wip_q_time_setting unique (product_id,route_id,from_step_id,to_step_id)
);
create index idx_wip_q_time_setting_1 on mes_wip_q_time_setting 
(product_id,route_id,from_step_id,delete_flag);

create table mes_wip_q_time_monitor(
	sysid              character varying(38)  ,
	lot_id             character varying(40)  ,
	from_step_id       character varying(40)  ,
  from_step_handle   character varying(40)  , 
  to_step_id         character varying(40)  ,  
  to_step_handle     character varying(40)  ,
	start_date         timestamp          ,	
	close_date         timestamp          ,
	close_type         char(1)       , --0:pass, 1:over qTime, 2:人工關閉, 3:Lot Terminate Merge Scrap
	close_user         character varying(10)  ,
	q_time             integer       ,
  q_time_type        char(1)       , -- 0:在設定時間內，1:需超過設定時間
    q_time_setting_sysid character varying(38)  , 
	delete_flag        char(1)  default '0', --0:監控中，1:已結束
  constraint pk_wip_q_time_monitor primary key (sysid)
);
create index idx_wip_q_time_monitor_1 on mes_wip_q_time_monitor 
(lot_id,to_step_handle,delete_flag);

create table mes_wip_q_time_history
(
  monitor_sysid      character varying(38)  , --q_time_monitor.sysid
  time_pass          integer       , --經過的時間(分)
  check_result       char(1)       , --0:pass, 1:over qTime
  create_user        character varying(10)  ,
  create_date        timestamp          
);
create index idx_wip_q_time_history_1 on mes_wip_q_time_history
(monitor_sysid);

create table mes_wip_lot_history(
	txn_sysid      character varying(45)  ,
	last_txn_sysid character varying(45)  ,
	main_txn_sysid character varying(38)  ,
	lot_sysid      character varying(38)  , --sysid to mes_wip_lot
	lot_id         character varying(40)  ,
	activity       character varying(20)  ,
	component_type character varying(40)  , --lot當下的原料型態(對應step的component_type)
	product_id     character varying(40)  ,
    product_type   character varying(20)  ,
	route_id       character varying(40)  ,
	route_version  numeric(3,0)   ,
	spec_id        character varying(40)  ,
	spec_sysid     character varying(38)  , --參數模組串接鍵
	status         character varying(40)  ,
	fab            character varying(40)  ,
	equipment_id   character varying(40)  ,
	step_id        character varying(40)  ,
	step_version   numeric(3,0)   ,
	iterate        numeric(2,0)  default 1 ,
	is_rework      char(1)       , 
	node_handle    character varying(40)  , --handle to mes_prp_routing_node
	rule_id        character varying(40)  ,
	rule_seq       numeric(2,0)   ,
	rule_result    character varying(40)  , --rule執行結果
	location       character varying(40)  , --bank時的儲位
	quantity       numeric(10,3)  ,
	unit           character varying(20)  ,
	component_info character varying(38)  , --lot_component_info to mes_wip_lot_component
	setup_info     character varying(38)  , --equipment setup info history
    ta_work_info   character varying(38)  , --ta_work_info to mes_ta_work_info
	tooling_setup_info   character varying(38)  ,
    finish_qty     numeric(10,3)  , --完工數
	order_id       character varying(40)  ,
	carrier_id     character varying(40)  ,	
	carrier_position numeric(3)           ,
	batch_id       character varying(40)  ,
	split_parent   character varying(40)  ,
	merge_parent   character varying(40)  ,
	txnstamp       integer       ,
	owner          character varying(10)  ,
	remark         character varying(255) ,
	grouphistkey   character varying(38)  ,
	eq_parm_seq    integer                ,
	hostname       character varying(60)  ,
	modify_user    character varying(10)  ,
	modify_date    timestamp(6)  ,
	delete_flag    char(1)  default '0',           
  constraint pk_wip_lot_history primary key (txn_sysid)
);
create index idx_wip_lot_history_1 on mes_wip_lot_history 
(last_txn_sysid);
create index idx_wip_lot_history_2 on mes_wip_lot_history 
(activity,modify_date);
create index idx_wip_lot_history_3 on mes_wip_lot_history 
(lot_id,modify_date);

create table mes_wip_lot_history_component(
	lot_component_info character varying(38)  ,
	component_sysid    character varying(38)  ,
  carrier_id         character varying(40)  ,
  position           integer       ,
	status             character varying(40)  ,
	integrity          numeric(4,3)   ,
  modify_date        timestamp      
);
create index idx_wip_lot_history_comp_1 on mes_wip_lot_history_component 
(lot_component_info);

create table mes_wip_lot_history_dc_item(
	txn_sysid      	character varying(45)  ,
	dc_item_sysid	character varying(38)  ,
	value		character varying(255) ,
  constraint pk_history_dc_item primary key(txn_sysid,dc_item_sysid)
);

create table mes_wip_lot_defect
(
  txn_sysid    character varying(45),
  reason_code  character varying(40),
  quantity     numeric(10,3),
  comments     character varying(255)
);
create index idx_wip_lot_defect_1 on mes_wip_lot_defect
(txn_sysid);

create table mes_ta_work_info
(
  sysid              character varying(38)  ,
  ta_work_info       character varying(38)  ,
  step_id            character varying(40)  ,
  equipment_id       character varying(40)  ,
  shift              character varying(10)  ,  --班別
  ta_count           numeric(3,0)   ,
  modify_date        timestamp          ,
  constraint pk_ta_work_info primary key (sysid),
  constraint uk_ta_work_info unique (ta_work_info),
  constraint uk_ta_work_info2 unique (step_id,equipment_id)
);

create table mes_ta_work_info_history
(
  ta_work_info       character varying(38)  ,
  shift              character varying(10)  ,  --班別
  ta_count           numeric(3,0)   ,
  modify_date        timestamp          ,
  constraint pk_work_info_his primary key (ta_work_info)
);
create index idx_work_info_history_1 on mes_ta_work_info_history 
(modify_date);

create table mes_ta_work_info_detail
(
  ta_work_info       character varying(38)  ,
  station            character varying(40)  ,
  user_id            character varying(10)
);
create index idx_work_info_detail_1 on mes_ta_work_info_detail 
(ta_work_info);

create table mes_ta_work_info_detail_his
(
  ta_work_info       character varying(38)  ,
  station            character varying(40)  ,
  user_id            character varying(10)
);
create index idx_work_info_detail_his_1 on mes_ta_work_info_detail_his 
(ta_work_info);

create table mes_wip_order(
	sysid              character varying(38)  ,
	order_id           character varying(40)  ,
	order_type         character varying(40)  ,
	product_id         character varying(40)  ,
	fab                character varying(40)  ,
  priority           numeric(2,0)   ,	
	route_id           character varying(40)  ,
	route_version      numeric(3,0)   ,
	start_step         character varying(40)  ,
	start_step_handle  character varying(40)  ,
	spec_id            character varying(40)  ,
	spec_sysid         character varying(38)  , --參數模組串接鍵
	quantity           integer       ,
	receive_quantity   integer default 0,
	start_quantity     integer default 0,
  scrap_quantity     integer default 0, --報廢數
  finish_quantity    integer default 0, --完工數
	lot_count          numeric(6,0) default 0,
	owner              character varying(10)  ,
	customer_id        character varying(40)  ,
  plan_start_date    timestamp          , --計劃投產日期
	due_date           timestamp          ,
	customer_due_date  timestamp          ,
	remark             character varying(255) ,
	status             character varying(40)  , --Created, Confirm, Hold, Closed, Finished
  txnstamp           integer default 0,
  create_user        character varying(10)  ,
	create_date        timestamp          ,	
	modify_user        character varying(10)  ,
	modify_date        timestamp          ,
	delete_flag        char(1)  default '0',	--for ERP是否已回報(0: not yet, 1: reported)
  constraint pk_wip_order primary key (sysid),
  constraint uk_wip_order unique (order_id)
);
create index idx_wip_order_1 on mes_wip_order 
(fab);
create index idx_wip_order_2 on mes_wip_order 
(status);
create index idx_wip_order_3 on mes_wip_order 
(receive_quantity);
create index idx_wip_order_4 on mes_wip_order 
(start_quantity);

create table mes_wip_instruction(
	sysid              character varying(38)  ,
	id                 character varying(40)  , --order_id or lot_id or product_id or route_id
	kind               char(1)       , --0:order, 1:lot, 2:route, 3:product
	step_id            character varying(40)  , 
  instruction        character varying(255) ,
  start_date         timestamp          ,
  expire_date        timestamp          ,
  create_user        character varying(10)  ,
	create_date        timestamp          ,	
	modify_user        character varying(10)  ,
	modify_date        timestamp          ,
	delete_flag        char(1)  default '0',
  constraint pk_wip_instruction primary key (sysid)
) ;
create index idx_wip_instruction_1 on mes_wip_instruction 
(id,kind);
create index idx_wip_instruction_2 on mes_wip_instruction 
(step_id,start_date,expire_date,delete_flag);

create table mes_wip_carton
(
  sysid              character varying(38)  ,
  carton_id          character varying(40)  ,
  fab                character varying(40)  ,
  product_id         character varying(40)  ,
  order_id           character varying(40)  ,
  location_type      char(1)       , --0:無，1:在機台，2:在棧板
  location           character varying(40)  , --所在位置(機台/棧板/None)
  pallet_use_id      character varying(55)  ,
  status             character varying(10)  , --WAIT, HOLD, CLOSE, SHIP
  txnstamp           integer default 0,
  create_user        character varying(10)  ,
  create_date        timestamp          ,	
  modify_user        character varying(10)  ,
  modify_date        timestamp          ,
  delete_flag        char(1)  default '0',
  constraint pk_wip_carton primary key (sysid),
  constraint uk_wip_carton unique (carton_id)
);
create index idx_wip_carton_1 on mes_wip_carton 
(location);
create index idx_wip_carton_2 on mes_wip_carton 
(pallet_use_id);

create table mes_wip_pallet
(
  sysid              character varying(38)  ,
  pallet_id          character varying(40)  ,
  use_id             character varying(55)  ,
  fab                character varying(40)  ,
  product_id         character varying(40)  ,
  order_id           character varying(40)  ,
  location_type      char(1)       , 
  location           character varying(40)  , 
  status             character varying(10)  , 
  txnstamp           integer default 0,
  create_user        character varying(10)  ,
  create_date        timestamp          ,	
  modify_user        character varying(10)  ,
  modify_date        timestamp          ,
  delete_flag        char(1)  default '0',
  constraint pk_wip_pallet primary key (sysid),
  constraint uk_wip_pallet unique (pallet_id),
  constraint uk_wip_pallet_2 unique (use_id)
);
create index idx_wip_pallet_1 on mes_wip_pallet 
(location);
--=====MaterialTracking Module==================================================================
create table mes_mat_step_material(
  sysid           character varying(38)  ,
  step_id         character varying(40)  ,
  material_type   character varying(40)  ,
  consume_rate    numeric(9,4)   default 0,
  required        char(1)       ,
  create_user     character varying(10)  ,
	create_date     timestamp          ,	
	modify_user     character varying(10)  ,
	modify_date     timestamp          ,
	delete_flag     char(1)  default '0',
  constraint pk_mat_step_material primary key(sysid),
  constraint uk_mat_step_material unique(step_id,material_type)
);
create index idx_mat_step_material_1 on mes_mat_step_material
(step_id);

create table mes_mat_part--耗用物料料號資訊
(
  sysid           character varying(38)  ,
  part_no         character varying(40)  ,
  material_type   character varying(40)  ,
  description     character varying(255) ,
  create_user     character varying(10)  ,
	create_date     timestamp          ,	
	modify_user     character varying(10)  ,
	modify_date     timestamp          ,
	delete_flag     char(1)  default '0',
  constraint pk_mat_part primary key(sysid),
  constraint uk_mat_part unique(part_no)
);

--=====ProcessParameter Module==================================================================
create table mes_parm_parameter(
  sysid           character varying(38)  ,
  parameter_id    character varying(40)  ,
  description     character varying(255) ,
  parm_type       numeric(1)             , --0:string, 1:numeric, 2:range
  dc_item_sysid   character varying(38)  , --mes_prp_step_dc_item.sysid
  eq_parm_sysid   character varying(38)  ,
  create_user     character varying(10)  ,
  create_date     timestamp          ,	
  modify_user     character varying(10)  ,
  modify_date     timestamp          ,
  delete_flag     char(1)  default '0',
  constraint pk_parm_parameter primary key(sysid),
  constraint uk__parm_parameter unique(parameter_id)
);

create table mes_parm_step_parameter(
  step_id         character varying(40)  ,
  parameter_sysid character varying(38)  ,
  seq             numeric(2,0)   ,
  constraint pk_parm_step_parameter primary key(step_id,parameter_sysid)
);

create table mes_parm_main(
  sysid           character varying(38)  ,
  name            character varying(40)  ,
  version         numeric(3)     ,
  description     character varying(255) ,
  issue_state     character varying(10)  ,
  create_user     character varying(10)  ,
  create_date     timestamp          ,
  modify_user     character varying(10)  ,
  modify_date     timestamp          ,
  delete_flag     char(1)       default '0',
  flag            numeric(3,0)   ,	
  constraint pk_parm_main primary key(sysid),
  constraint uk_parm_main unique(name,version)
);
create index idx_parm_main_1 on mes_parm_main
(name,flag);
create index idx_parm_main_2 on mes_parm_main
(name,issue_state);

create table mes_parm_main_step(
  sysid           character varying(79)  , --mes_parm_main.sysid +'@'+ step_id
  main_sysid      character varying(38)  , --mes_parm_main.sysid
  step_id         character varying(40)  ,
  std_process_time numeric(9,4)  , --標準作業時間(分/片)
  create_user     character varying(10)  ,
  create_date     timestamp          ,
  modify_user     character varying(10)  ,
  modify_date     timestamp          ,
  constraint pk_parm_main_step primary key(sysid),
  constraint uk_parm_main_step unique(main_sysid,step_id)
);
create index idx_parm_main_step_1 on mes_parm_main_step
(main_sysid);

create table mes_parm_main_step_material(
  sysid           character varying(120) , --mes_parm_main_step.sysid +'@'+ material_type
  main_step_sysid character varying(79)  , --mes_parm_main_step.sysid
  material_type   character varying(40)  ,
  required        char(1)       , --0:false, 1:true
  create_user     character varying(10)  ,
  create_date     timestamp          ,
  modify_user     character varying(10)  ,
  modify_date     timestamp          ,
  constraint pk_parm_main_step_material primary key(sysid),
  constraint uk_parm_main_step_material unique(main_step_sysid,material_type)
);
create index idx_parm_main_step_material_1 on mes_parm_main_step_material
(main_step_sysid);

create table mes_parm_main_step_mat_part(
  from_sysid          character varying(120) , --mes_parm_main_step_material.sysid
  part_no             character varying(40)  ,
  consume_rate        numeric(9,4)  default 0,
  seq                 numeric(2,0)   ,
  constraint pk_step_material_part primary key(from_sysid,part_no)
);
create index idx_step_material_part_1 on mes_parm_main_step_mat_part
(from_sysid);


create table mes_parm_main_step_recipe(
  sysid           character varying(120) , --mes_parm_main_step.sysid +'@'+ eq_type
  main_step_sysid character varying(79)  , --mes_parm_main_step.sysid
  eq_type         character varying(40)  ,
  recipe          character varying(40)  ,
  create_user     character varying(10)  ,
  create_date     timestamp          ,
  modify_user     character varying(10)  ,
  modify_date     timestamp          ,
  constraint pk_parm_main_step_recipe primary key(sysid),
  constraint uk_parm_main_step_recipe unique(main_step_sysid,eq_type)
);
create index idx_parm_main_step_recipe_1 on mes_parm_main_step_recipe
(main_step_sysid);

create table mes_parm_main_step_eq_track
(
  sysid           character varying(38)  , 
  main_step_sysid character varying(79)  , --mes_parm_main_step.sysid
  eq_type         character varying(40)  ,
  track           character varying(20)  , --軌道
  seq             numeric(3,0)   ,
  create_user     character varying(10)  ,
  create_date     timestamp          ,
  modify_user     character varying(10)  ,
  modify_date     timestamp          ,
  constraint pk_parm_main_step_eq_track primary key(sysid)
);
create index idx_parm_main_step_eq_track_1 on mes_parm_main_step_eq_track
(main_step_sysid);

create table mes_parm_main_step_parameter(
  sysid           character varying(120) , --mes_parm_main_step.sysid +'@'+ parameter_sysid
  main_step_sysid character varying(79)  , --mes_parm_main_step.sysid
  parameter_sysid character varying(38)  , --mes_parm_step_parameter.sysid
  value           character varying(255) ,
  max             numeric(10,4)  ,
  min             numeric(10,4)  ,
  seq             numeric(2,0)   ,
  remark          character varying(255) ,
  create_user     character varying(10)  ,
  create_date     timestamp          ,
  modify_user     character varying(10)  ,
  modify_date     timestamp          ,
  constraint pk_parm_main_step_parameter primary key(sysid),
  constraint uk_parm_main_step_parameter unique(main_step_sysid,parameter_sysid)
);
create index idx_parm_main_step_parameter_1 on mes_parm_main_step_parameter
(main_step_sysid);

create table mes_parm_product_spec(
  product_id      character varying(40) ,
  spec_name       character varying(40) ,
  restriction     character varying(255),
  constraint pk_product_spec primary key(product_id,spec_name)
);
create index idx_product_spec_1 on mes_parm_product_spec
(product_id);
create index idx_product_spec_2 on mes_parm_product_spec
(spec_name);

create table mes_parm_main_step_eq_tooling
(
  sysid              character varying(120) ,
  main_step_sysid    character varying(79)  ,
  eq_type            character varying(40)  ,
  tooling_type       character varying(40)  ,
  create_user        character varying(10)  ,
  create_date        timestamp      default now(),
  modify_user        character varying(10)  ,
  modify_date        timestamp      default now(),
  delete_flag        char(1)        default '0',
  constraint pk_step_eq_tooling primary key(sysid)
);
create index idx_step_eq_tooling_1 on mes_parm_main_step_eq_tooling 
(main_step_sysid);

create table mes_parm_main_step_eq_tol_part
(
  from_sysid    character varying(120) ,
  part_no       character varying(40)  ,
  seq           numeric(2,0)  ,
  constraint pk_step_eq_tol_part primary key(from_sysid,part_no)
);

--======FAB Monitor Module======================================
create table fms_area(
  sysid           character varying(38)  ,
  area_id         character varying(40)  ,
  description     character varying(255) ,
  image_file      character varying(40)  ,
  create_user     character varying(10)  ,
  create_date     timestamp          ,
  modify_user     character varying(10)  ,
  modify_date     timestamp          ,
  delete_flag     char(1)       default '0',
  constraint pk_fms_area primary key(sysid),
  constraint uk_fms_area unique(area_id)
);

create table fms_area_equipment(
  area_sysid      character varying(38)  ,
  equipment_sysid character varying(38)  ,
  pos_x           integer       ,
  pos_y           integer       ,
  width           integer       ,
  height          integer       ,
  graph_type      numeric(2,0)   ,
  constraint pk_area_equipment primary key(area_sysid,equipment_sysid)
);
create index idx_area_equipment_1 on fms_area_equipment
(area_sysid);

--標籤管理========================================================
create table mes_lbl_misc  --標籤雜項，a ItemType:LabelType= Carton, Box, Pallet...
(
	item			character varying(20)	,
	value			character varying(40)	,
	description		character varying(40)	,
    modify_user     character varying(10)   ,
    modify_date     timestamp               ,	
	constraint pk_lbl_misc primary key(item,value)
);

create table mes_lbl_printer
(
    sysid           character varying(38)	 ,
    model_name      character varying(40)    , --印表機型號
	resolution      numeric(4)		         , --解析度
	landscape       char(1)                  , --列印方向。0:直印，1:橫印
	description     character varying(100)   ,
	modify_user     character varying(10)    ,
    modify_date     timestamp                     ,	
	constraint pk_lbl_printer primary key(sysid),
	constraint uk_lbl_printer unique(model_name,resolution)
);

create table mes_lbl_code
(
	sysid			character varying(38)	,
	code			character varying(40)	,
	description		character varying(40)	,
    modify_user     character varying(10)   ,
    modify_date     timestamp               ,	
	constraint pk_lbl_code primary key(sysid),
	constraint uk_lbl_code unique(code)
);

create table mes_lbl_label
(
	sysid			character varying(38)	,
	code_sysid		character varying(38)	,
	label_type		character varying(40)	, --Carton,Box,Pallet...
	printerModel    character varying(40)   , --印表機型號
	resolution		numeric(4)			    , --解析度
	height			numeric(7,2)			, --標籤高度 
	width			numeric(7,2)			, --標籤寬度	
    modify_user     character varying(10)   ,
    modify_date     timestamp               ,
	constraint pk_lbl_label primary key(sysid),
	constraint uk_lbl_label unique(code_sysid,label_type,printerModel,resolution)
);

create table mes_lbl_label_detail
(
	sysid			character varying(38)	,
	label_sysid		character varying(38)	,
	item_type		character varying(20)	, --項目類型 Text,Barcode,Image,Line,Ellipse,Rectangle
	item_value		character varying(100)	,
	seq				numeric(2)			    ,
	color			integer				    ,
	pos_x			numeric(7,2)		    ,
	pos_y			numeric(7,2)		    ,
	height			numeric(7,2)		    ,
	width			numeric(7,2)		    ,
	bar_type		character varying(20)	,
	bar_size        numeric(1)		        ,
	bar_text_align  numeric(1)		        ,
	bar_rotation    numeric(1)		        ,
	font_name		character varying(40)	,
	font_size		numeric(4,2)		    ,
	data_source		character varying(40)	,
	data_member		character varying(40)	,
    modify_user     character varying(10)   ,
    modify_date     timestamp               ,	
	constraint pk_lbl_label_detail primary key(sysid)
);
create index idx_lbl_label_detail_1 on mes_lbl_label_detail(label_sysid);
--其它==================================================================================================
create table mes_message_box_record
(
    msg_level    char(1), --confirmation=0, askYesNo=1, askOKCancel=2, error=3
    message        character varying(255),
    result    char(1),  
    hostname    character varying(40),
    modify_user    character varying(10),
    modify_date timestamp
);
create index idx_message_box_1 on mes_message_box_record
(modify_date);

create table mes_wip_lot_extension
(
    item          character varying(40),
    step_id       character varying(40),
    ext_name      character varying(40),
    value         character varying(255),
    modify_date   timestamp,
    constraint pk_wip_lot_extension primary key(item,step_id,ext_name)
);
--警報管理==========================================================================================
create table mes_alm_type
(
  sysid               character varying(38)  ,
  alarm_type          character varying(40)  ,
  description         character varying(255) ,
  reason_group        character varying(40)  ,
  modify_user         character varying(10)  ,
  modify_date         timestamp      default now(),
  delete_flag         char(1)       default '0',
  constraint pk_alm_type primary key(sysid),
  constraint uk_alm_type unique(alarm_type)
);

create table mes_alm_reason
(
  sysid               character varying(38)  ,
  type_sysid          character varying(38)  ,
  reason_code         character varying(40)  ,
  level_count         numeric(1,0)  ,
  modify_user         character varying(10)  ,
  modify_date         timestamp      ,
  delete_flag         char(1)       default '0',
  constraint pk_alm_reason primary key(sysid),
  constraint uk_alm_reason unique(type_sysid,reason_code)
);

create table mes_alm_level
(
  sysid               character varying(38)  ,
  reason_sysid        character varying(38)  ,
  alm_level           numeric(1,0)  ,
  cycle               numeric(1,0)  ,
  interval_min        numeric(3,0)  , 
  send_wechat         character varying(255) ,
  send_email          character varying(1000),
  send_line           character varying(255) ,
  language            character varying(10)  ,
  modify_user         character varying(10)  ,
  modify_date         timestamp      ,
  delete_flag         char(1)       default '0',
  constraint pk_alm_level primary key(sysid),
  constraint uk_alm_level unique(reason_sysid,alm_level)
);

create table mes_alm_message
(
  sysid               character varying(38)  ,
  alarm_type          character varying(40)  ,
  priority            numeric(3,0)  ,
  title               character varying(100) ,
  message             character varying(500) ,
  status              char(1)       , 
  object_id           character varying(40)  ,
  object_type         character varying(40)  ,
  reason_code         character varying(40)  ,
  comments            character varying(255) ,
  grouphistkey        character varying(45)  ,
  action_comments     character varying(255) ,
  clear_reason        character varying(40)  ,
  clear_comments      character varying(255) ,
  clear_grouphistkey  character varying(45)  ,
  cur_level           numeric(1,0)  ,
  cur_cycle           numeric(1,0)  ,
  last_send           timestamp      ,
  create_date         timestamp      ,
  modify_user         character varying(10)  ,
  modify_date         timestamp      ,
  clear_user          character varying(10)  ,
  clear_date          timestamp      ,
  delete_flag         char(1)       default '0',
  constraint pk_alm_message primary key(sysid),
  constraint uk_alm_message unique(alarm_type,object_id,reason_code)
);
create index idx_alm_message_1 on mes_alm_message
(object_type);

create table mes_alm_message_his
(
  sysid               character varying(38)  ,
  alarm_type          character varying(40)  ,
  priority            numeric(3,0)  ,
  title               character varying(100) ,
  message             character varying(500) ,
  object_id           character varying(40)  ,
  object_type         character varying(40)  ,
  reason_code         character varying(40)  ,
  comments            character varying(255) ,
  grouphistkey        character varying(45)  ,
  action_comments     character varying(255) ,
  clear_reason        character varying(40)  ,
  clear_comments      character varying(255) ,
  clear_grouphistkey  character varying(45)  ,
  cur_level           numeric(2,0)  ,
  create_date         timestamp      ,
  modify_user         character varying(10)  ,
  modify_date         timestamp      ,
  clear_user          character varying(10)  ,
  clear_date          timestamp      ,
  constraint pk_alm_message_his primary key(sysid)
);
create index idx_alm_message_his_1 on mes_alm_message_his
(alarm_type,reason_code);
create index idx_alm_message_his_2 on mes_alm_message_his
(create_date);

--治工具管理==========================================================================================
create table mes_tol_tooling_type
(
  sysid           character varying(38)  ,
  tooling_type	  character varying(40)  ,       
  description     character varying(255) ,
  control_type	  char(1) default '0',  
  consume_type    char(1) default '0',  
  verify_flag     char(1) default '1',  
  runtime_flag    char(1) default '0', 
  owner_dept 	  character varying(20) 	,       
  create_user     character varying(10)  ,
  create_date     timestamp      default now(),
  modify_user     character varying(10)  ,
  modify_date     timestamp      default now(),
  delete_flag     char(1)       default '0',
  constraint pk_tooling_type primary key(sysid),
  constraint uk_tooling_type unique(tooling_type)
);

create table mes_tol_tooling_type_link
(
  type_sysid      character varying(38)  ,       
  eq_type         character varying(40)  ,       
  constraint pk_tooling_type_link primary key(type_sysid,eq_type)
);

create table mes_tol_part
(
  sysid           character varying(38)  ,
  part_no	      character varying(40)  ,
  description     character varying(255) ,
  type_sysid      character varying(38)  , 
  use_limit       numeric(6,0) default 0 ,
  use_notice      numeric(6,0) default 0 ,
  create_user     character varying(10)  ,
  create_date     timestamp     default now(),
  modify_user     character varying(10)  ,
  modify_date     timestamp     default now(),
  delete_flag     char(1)       default '0',
  constraint pk_tol_part primary key(sysid),
  constraint uk_tol_part unique(part_no)
);
create index idx_part_no_1 on mes_tol_part
(type_sysid);

create table mes_tol_event
(
  sysid           character varying(38) ,
  type_sysid      character varying(38) ,       
  event_name      character varying(40)	,       
  last_status     character varying(10)	,       
  next_status     character varying(10)	,       
  reason_group    character varying(40)	,       
  location_list	  character varying(1000), 
  ide_flag        char(1)       default '1',  
  create_user     character varying(10)  ,
  create_date     timestamp     default now(),
  modify_user     character varying(10)  ,
  modify_date     timestamp     default now(),
  delete_flag     char(1)       default '0',
  constraint pk_tol_event primary key(sysid),
  constraint uk_tol_event unique(type_sysid,last_status,event_name)
);

create table mes_tol_tooling_id
(
  sysid           character varying(38) ,
  tooling_id      character varying(40) ,            
  part_no         character varying(40)	,
  location        character varying(40)	,
  location_type   char(1)               default '0', 
  status          character varying(10) ,           
  last_status     character varying(10) ,           
  current_count   numeric(6,0)          default 0  , 
  use_count       numeric(6,0)          default 0  , 
  total_count     numeric(10,0)         default 0  , 
  clean_count     numeric(6,0)          default 0  , 
  pm_count        numeric(6,0)          default 0  , 
  repair_count    numeric(6,0)          default 0  , 
  last_txn_sysid  character varying(38) ,
  setup_user      character varying(10) ,
  setup_date      timestamp             , 
  start_date      timestamp             , 
  txnstamp        integer               default 0  ,
  create_user     character varying(10) ,
  create_date     timestamp             default now(),
  modify_user     character varying(10) ,
  modify_date     timestamp             default now(),
  delete_flag     char(1)               default '0',
  constraint pk_tol_tooling_id primary key(sysid),
  constraint uk_tol_tooling_id unique(tooling_id)
);
create index idx_tooling_id_1 on mes_tol_tooling_id
(part_no);
create index idx_tooling_id_2 on mes_tol_tooling_id
(location);
create index idx_tooling_id_3 on mes_tol_tooling_id
(status);

create table mes_tol_tooling_history
(
  txn_sysid       character varying(38)  ,
  main_txn_sysid  character varying(38)  ,
  last_txn_sysid  character varying(38)  ,
  tooling_id      character varying(40)  ,     
  event_name      character varying(40)  ,    
  part_no         character varying(40)	 ,            
  location        character varying(40)	 ,            
  location_type   char(1)                default '0', 
  lot_id          character varying(40)  , 
  status          character varying(10)  ,            
  last_status     character varying(10)  ,            
  current_count   numeric(6,0)           default 0  , 
  use_count       numeric(6,0)           default 0  , 
  total_count     numeric(10,0)          default 0  , 
  clean_count     numeric(6,0)           default 0  , 
  pm_count        numeric(6,0)           default 0  , 
  repair_count    numeric(6,0)           default 0  ,          
  setup_user      character varying(10)  ,
  setup_date      timestamp              , 
  start_date      timestamp              , 
  txnstamp        integer                default 0  ,
  reason_code     character varying(40)  , 
  comments        character varying(255) , 
  modify_user     character varying(10)  ,
  modify_date     timestamp              default now(),
  delete_flag     char(1)                default '0',
  constraint pk_tooling_history primary key(txn_sysid)
);
create index idx_tooling_history_1 on mes_tol_tooling_history 
(last_txn_sysid);
create index idx_tooling_history_2 on mes_tol_tooling_history 
(event_name,modify_date);
create index idx_tooling_history_3 on mes_tol_tooling_history 
(tooling_id,modify_date);

--看板管理==================================================================================================
create table mes_kan_screen
(
  sysid            character varying(38)  ,
  assembly_name    character varying(40)  ,
  description      character varying(255) ,
  refresh_interval numeric(5)    ,  
  modify_user      character varying(10)  ,
  modify_date      timestamp     default now(),
  delete_flag      char(1)       default '0',
  constraint pk_kan_screen primary key(sysid),
  constraint uk_kan_screen unique(assembly_name)
);

create table mes_kan_screen_argu
(
  from_sysid       character varying(38)  , --mes_kan_screen.sysid
  argument_name    character varying(40)  ,
  description      character varying(255) , 
  constraint pk_kan_screen_argu primary key(from_sysid,argument_name)
);

create table mes_kan_client
(
  sysid           character varying(38)  ,
  computer_name   character varying(40)  ,
  seq             numeric(1) default 0,
  description     character varying(255) ,
  screen_split    numeric(1) default 0, --0:單一畫面,1:分左右,2:左邊分上下,3:右邊分上下,4:4格,5:分上下,6:上面分左右,7:下面分左右
  percent_ver     numeric(2) default 0, --垂直比例
  percent_hor     numeric(2) default 0, --水平比例
  client_id       character varying(100) ,
  modify_user     character varying(10)  ,
  modify_date     timestamp  default now(),
  delete_flag     char(1)    default '0',
  constraint pk_kan_client primary key(sysid),
  constraint uk_kan_client unique(computer_name,seq)
);

create table mes_kan_client_screen
(
  sysid           character varying(38)  ,
  client_sysid    character varying(38)  ,
  screen_sysid    character varying(38)  ,
  seq             numeric(1) default 0,
  constraint pk_kan_client_screen primary key(sysid)
);
create index idx_kan_client_screen_1 on mes_kan_client_screen
(client_sysid,screen_sysid);

create table mes_kan_client_screen_argu
(
  from_sysid      character varying(38)  , --mes_kan_client_screen.sysid
  argument_name   character varying(40)  ,
  value           character varying(100) ,
  constraint pk_kan_client_screen_argu primary key(from_sysid,argument_name)
);